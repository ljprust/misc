SUBROUTINE CURVEMULT(NPOINTS,NBASIS,Y,Z,A,B)

INTEGER :: I,J,K
REAL*8 :: Y(NPOINTS),Z(NBASIS,NPOINTS),A(NBASIS,NBASIS),B(NBASIS),ZTRANS(NPOINTS,NBASIS)

! FIND TRANSPOSE OF Z

ZTRANS=TRANSPOSE(Z)

! INITIALIZE A MATRIX

DO I=1,NBASIS
	DO J=1,NBASIS
		A(I,J)=0.0
	END DO
END DO

! ACCUMULATE A MATRIX

DO I=1,NBASIS
	DO J=1,NBASIS
		DO K=1,NPOINTS
			A(I,J)=A(I,J)+Z(I,K)*ZTRANS(K,J)
		END DO
	END DO
END DO

! INITIALIZE B VECTOR

DO I=1,NBASIS
	B(I)=0
END DO

! ACCUMULATE B VECTOR

DO I=1,NBASIS
	DO K=1,NPOINTS
		B(I)=B(I)+Z(I,K)*Y(K)
	END DO
END DO

RETURN
END